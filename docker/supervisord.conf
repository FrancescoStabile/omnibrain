[supervisord]
nodaemon=true
logfile=/dev/stdout
logfile_maxbytes=0
loglevel=info

[program:backend]
command=/opt/venv/bin/python -m omnibrain api --host %(ENV_OMNIBRAIN_API_HOST)s --port %(ENV_OMNIBRAIN_API_PORT)s
directory=/app
autorestart=true
startretries=5
startsecs=5
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
environment=
    PYTHONPATH="/app/src",
    HOME="/data"

[program:frontend]
command=node_modules/.bin/next start -p %(ENV_OMNIBRAIN_FRONTEND_PORT)s
directory=/app/web
autorestart=true
startretries=5
startsecs=10
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
environment=
    OMNIBRAIN_API_HOST="127.0.0.1",
    OMNIBRAIN_API_PORT="%(ENV_OMNIBRAIN_API_PORT)s",
    NODE_ENV="production"
